"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DRAG_DISTANCE_THRESHOLD=10;var preloading;var canvasElement,canvas,invisibleCanvasElement,invisCanvas;var windowWidth,windowHeight,width,height;var looping=false,frameRate=undefined,lastFrameTime=0,frameCount=0;var font="sans-serif",fontSize="10px";var mouseIsDown=false,mouseX=0,mouseY=0;var canvasX=0,canvasY=0;var key="",keycode=-1,keys=[],shift=false;var startTime;var dragStartX,dragStartY,dragging;var _audioManager=undefined;document.addEventListener("DOMContentLoaded",function(event){initPoppsJS()});function initPoppsJS(){windowWidth=window.innerWidth;windowHeight=window.innerHeight;startTime=new Date;if(typeof preload==="function"&&typeof setup==="function"){preloading=true;preload();preloadInterval=setInterval(function(){if(itemsLoaded==preloadCounter){preloading=false;clearInterval(preloadInterval);startPoppsJs()}},10)}else if(typeof setup==="function"){startPoppsJs()}}function startPoppsJs(){listeners();setup()}var Listener=function(){function Listener(callbackFunc){_classCallCheck(this,Listener);this.callback=callbackFunc}_createClass(Listener,[{key:"event",value:function event(){this.callback()}}]);return Listener}();var MouseListener=function(_Listener){_inherits(MouseListener,_Listener);function MouseListener(callbackFunc,canvas){_classCallCheck(this,MouseListener);var _this=_possibleConstructorReturn(this,(MouseListener.__proto__||Object.getPrototypeOf(MouseListener)).call(this,callbackFunc));_this.canvas=canvas;_this.mouseX=0;_this.mouseY=0;_this.mouseDown=false;_this.mouseMovedCallback;_this.mouseClickedCallback;_this.mouseDraggedCallback;_this.mouseUpCallback;_this.mouseDownCallback;return _this}_createClass(MouseListener,[{key:"listenTo",value:function listenTo(eventType,callback){switch(eventType){case"move":this.canvas.addEventListener("mousemove",function(event){this.mouseMovedEvent(event)});this.mouseMovedCallback=callback;break;case"click":this.canvas.addEventListener("click",function(event){this.mouseClickedEvent(event)});this.mouseClickedCallback=callback;break;case"drag":this.canvas.addEventListener("mousedown",function(event){this.mouseDownEvent(event)});this.canvas.addEventListener("mousemove",function(event){this.mouseDraggedEvent(event)});this.mouseDraggedCallback=callback;break;case"mouseup":this.canvas.addEventListener("mouseup",function(event){this.mouseUpEvent(event)});this.mouseUpCallback=callback;break;case"mousedown":this.canvas.addEventListener("mousedown",function(event){this.mouseDownEvent(event)});this.mouseDownCallback=callback;break;}}},{key:"updateMouseCoordinates",value:function updateMouseCoordinates(event){mouseX=e.pageX-canvasX;mouseY=e.pageY-canvasY}},{key:"mouseMovedEvent",value:function mouseMovedEvent(event){updateMouseCoordinates(event);this.mouseMovedCallback()}},{key:"mouseClickedEvent",value:function mouseClickedEvent(event){updateMouseCoordinates(event);this.mouseClickedCallback()}},{key:"mouseDraggedEvent",value:function mouseDraggedEvent(event){if(this.mouseDown){updateMouseCoordinates(event);this.mouseDraggedCallback()}}},{key:"mouseUpEvent",value:function mouseUpEvent(event){updateMouseCoordinates(event);this.mouseDown=false;this.mouseUpCallback()}},{key:"mouseDownEvent",value:function mouseDownEvent(event){updateMouseCoordinates(event);this.mouseDown=true;this.mouseDownCallback()}}]);return MouseListener}(Listener);function listeners(){if(typeof mouseDown==="function"){document.addEventListener("mousedown",function(e){mouseDownListener(e)})}if(typeof mouseUp==="function"){document.addEventListener("mouseup",function(e){mouseUpListener(e)})}if(typeof mouseMoved==="function"){document.addEventListener("mousemove",function(e){mouseMovedListener(e)})}if(typeof mouseClicked==="function"){document.addEventListener("click",function(e){mouseClickedListener(e)})}if(typeof mouseDragged==="function"){document.addEventListener("mousedown",function(e){dragStartX=event.pageX;dragStartY=event.pageY;mouseIsDown=true});document.addEventListener("mousemove",function(e){if(mouseIsDown&&abs(dragStartX-event.pageX)>DRAG_DISTANCE_THRESHOLD&&abs(dragStartY-event.pageY)>DRAG_DISTANCE_THRESHOLD){dragging=true}if(dragging){mouseDraggedListener(e)}});document.addEventListener("mouseup",function(){mouseIsDown=false;setTimeout(function(){dragging=false},10)})}if(typeof keyPressed==="function"){document.addEventListener("keypress",function(e){keyPressedListener(e)})}if(typeof keyDown==="function"){document.addEventListener("keydown",function(e){keyDownListener(e)});document.addEventListener("keyup",function(e){removeKey(e.key)})}if(typeof keyUp==="function"){document.addEventListener("keyup",function(e){keyUpListener(e)})}if(typeof windowResized==="function"){window.addEventListener("resize",windowResizedListener)}}function updateMouseCoords(e){mouseX=e.pageX-canvasX;mouseY=e.pageY-canvasY}function mouseMovedListener(e){updateMouseCoords(e);mouseMoved(e)}function mouseClickedListener(e){if(!dragging){updateMouseCoords(e);mouseClicked(e)}}function mouseDownListener(e){mouseIsDown=true;updateMouseCoords(e);mouseDown(e)}function mouseUpListener(e){mouseIsDown=false;updateMouseCoords(e);mouseUp(e)}function mouseDraggedListener(e){updateMouseCoords(e);mouseDragged(e)}function updateKeys(e){key=e.key;keycode=e.keyCode}function addKey(k){if(keycode==16){shifting=true}else{k=k.toLowerCase();if(keys.indexOf(k)==-1&&k.length==1){keys.push(k)}}}function removeKey(k){if(keycode==16){shifting=false}else{k=k.toLowerCase();for(var i=keys.length-1;i>=0;i--){if(keys[i]==k)keys.splice(i,1)}}}function keyPressedListener(e){updateKeys(e);keyPressed(e)}function keyDownListener(e){updateKeys(e);addKey(e.key);keyDown(e)}function keyUpListener(e){updateKeys(e);removeKey(e.key);keyUp(e)}function keyIsDown(k){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=keys[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _key=_step.value;if(k==_key)return true}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return false}function windowResizedListener(){windowWidth=window.innerWidth;windowHeight=window.innerHeight;windowResized()}function loop(f){looping=true;frameCount=0;if(f){frameRate=f;frameTime=1000/f}requestAnimationFrame(frameUpdate)}function noLoop(){looping=false}function frameUpdate(){if(looping){requestAnimationFrame(frameUpdate);if(frameRate&&millis()-lastFrameTime>frameTime){frameCount++;draw()}else if(frameRate===undefined){frameCount++;draw()}}}function millis(){var endTime=new Date;return endTime-startTime}function createCanvas(w,h,parent){if(parent){canvasElement=document.getElementById(""+parent)}else{canvasElement=document.createElement("canvas");document.getElementsByTagName("BODY")[0].append(canvasElement)}canvas=canvasElement.getContext("2d");canvas.canvas.width=w;canvas.canvas.height=h;width=w;height=h;var r=canvasElement.getBoundingClientRect();canvasX=r.left;canvasY=r.top;window.addEventListener("scroll",function(event){var r=canvasElement.getBoundingClientRect();scrollTop=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;scrollLeft=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;canvasX=r.left+scrollLeft;canvasY=r.top+scrollTop});return canvas}function createInvisibleCanvas(){if(invisCanvas==undefined){invisibleCanvasElement=document.createElement("canvas");invisCanvas=invisibleCanvasElement.getContext("2d");invisCanvas.canvas.width=0;invisCanvas.canvas.height=0;return invisibleCanvasElement}}function resizeCanvas(w,h){canvas.canvas.width=w;canvas.canvas.height=h;width=w;height=h}function resizeInvisibleCanvas(w,h){if(invisCanvas!=undefined){invisCanvas.canvas.width=w;invisCanvas.canvas.height=h;invisibleCanvasElement.style.width=w;invisibleCanvasElement.style.height=h}}function fill(r,g,b,a){var f="rgb";if(r===undefined){f+="(0,0,0)";canvas.fillStyle=f;return}r=Math.round(r);if(g===undefined){f+="("+r+","+r+","+r+")";canvas.fillStyle=f;return}g=Math.round(g);b=Math.round(b);if(a===undefined){f+="("+r+","+g+","+b+")";canvas.fillStyle=f;return}f+="a("+r+","+g+","+b+","+a;canvas.fillStyle=f;return}function stroke(r,g,b,a){var f="rgb";if(r===undefined){f+="(0,0,0)";canvas.strokeStyle=f;return}r=Math.round(r);if(g===undefined){f+="("+r+","+r+","+r+")";canvas.strokeStyle=f;return}g=Math.round(g);b=Math.round(b);if(a===undefined){f+="("+r+","+g+","+b+")";canvas.strokeStyle=f;return}f+="a("+r+","+g+","+b+","+a;canvas.strokeStyle=f;return}function strokeWidth(w){canvas.lineWidth=w}function noStroke(){canvas.strokeStyle="transparent"}function font(f){font=f;canvas.font=""+fontSize+font}function fontSize(s){fontSize=s;canvas.font=""+fontSize+font}function background(r,g,b,a){var t=canvas.fillStyle;fill(r,g,b,a);canvas.beginPath();canvas.rect(0,0,width,height);canvas.fill();canvas.fillStyle=t}function clearBackground(){canvas.clearRect(0,0,width,height)}function rect(x1,y1,x2,y2){canvas.beginPath();canvas.rect(x1,y1,x2,y2);canvas.fill()}function strokeRect(x1,y1,x2,y2){canvas.beginPath();canvas.rect(x1,y1,x2,y2);canvas.stroke()}function line(x1,y1,x2,y2,w){canvas.beginPath();canvas.moveTo(x1,y1);canvas.lineTo(x2,y2);if(w){var t=canvas.lineWidth;strokeWidth(w);canvas.stroke();strokeWidth(t)}else{canvas.stroke()}}function ellipse(x,y,r){canvas.beginPath();if(r){canvas.arc(x,y,r,0,2*Math.PI)}else{canvas.arc(x,y,1,0,2*Math.PI)}canvas.fill()}function strokeEllipse(x,y,r){canvas.beginPath();if(r){canvas.arc(x,y,r,0,2*Math.PI)}else{canvas.arc(x,y,1,0,2*Math.PI)}canvas.stroke()}function arc(x,y,r,startAngle,endAngle,ant){canvas.beginPath();if(ant){canvas.arc(x,y,r,startAngle,endAngle,true)}else{canvas.arc(x,y,r,startAngle,endAngle)}canvas.fill()}function strokeArc(x,y,r,startAngle,endAngle,ant){canvas.beginPath();if(ant){canvas.arc(x,y,r,startAngle,endAngle,true)}else{canvas.arc(x,y,r,startAngle,endAngle)}canvas.stroke()}function point(x,y,r){canvas.beginPath();if(r){canvas.arc(x,y,r,0,2*Math.PI)}else{canvas.arc(x,y,1,0,2*Math.PI)}canvas.fill()}function strokePoint(x,y,r){canvas.beginPath();if(r){canvas.arc(x,y,r,0,2*Math.PI)}else{canvas.arc(x,y,1,0,2*Math.PI)}canvas.stroke()}function text(t,x,y){canvas.fillText(t,x,y)}function strokeText(t,x,y){canvas.strokeText(t,x,y)}function image(img,sx,sy,sWidth,sHeight,x,y,width,height){if(img!=undefined){if(sWidth===undefined){canvas.drawImage(img,sx,sy)}else if(x===undefined){canvas.drawImage(img,sx,sy,sWidth,sHeight)}else{canvas.drawImage(img,sx,sy,sWidth,sHeight,x,y,width,height)}}}preloadCounter=0;itemsLoaded=0;function loadJSON(path){if(preloading)preloadCounter++;var req=new XMLHttpRequest;req.overrideMimeType("application/json");req.open("GET",path,false);req.send(null);if(req.readyState==4&&req.status=="200"){if(preloading){itemsLoaded++}return JSON.parse(req.responseText)}else{console.log("Error loading JSON")}}function loadImage(url){if(preloading)preloadCounter++;var img=new Image;if(preloading){img.onload=function(){itemsLoaded++}}img.src=url;return img}function getCropped(img,sx,sy,width,height){createInvisibleCanvas();resizeInvisibleCanvas(width,height);invisCanvas.drawImage(img,sx,sy,width,height,0,0,width,height);return loadImage(invisibleCanvasElement.toDataURL())}function loadAudio(src){if(_audioManager==undefined)initializeAudio();return new PoppsSoundBuffer(src)}function initializeAudio(){_audioManager=new PoppsAudioManager}function loadBuffer(src,pointer){var request=new XMLHttpRequest;request.open("GET",src,true);request.responseType="arraybuffer";request.onload=function(){_audioManager.audioContext.decodeAudioData(request.response,function(buffer){pointer.ready=true;pointer.buffer=buffer;_audioManager.sounds.push(pointer)},function(e){console.log("Fail")})};request.send()}function PoppsAudioManager(){this.sounds=[];this.activeSounds=[];this.audioContext=new AudioContext}function playSound(poppsSoundBuffer,delay,startPoint,duration){return new PoppsSound(poppsSoundBuffer,delay,startPoint,duration)}function stopAllSounds(){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=_audioManager.activeSounds[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var s=_step2.value;s.stop()}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}_audioManager.activeSounds=[]}function PoppsSoundBuffer(src){this.ready=false;loadBuffer(src,this)}function PoppsSound(poppsSoundBuffer,delay,startPoint,duration){var _this2=this;this.playing=true;this.loops=false;this.sound=_audioManager.audioContext.createBufferSource();if(poppsSoundBuffer.ready){this.init(poppsSoundBuffer,delay,startPoint,duration)}else{var bufferCheckInterval=setInterval(function(){if(poppsSoundBuffer.ready){clearInterval(bufferCheckInterval);bufferCheckInterval=undefined;_this2.init(poppsSoundBuffer,delay,startPoint,duration)}},10)}this.sound.onended=function(){this.delete()}.bind(this)}PoppsSound.prototype.init=function(poppsSoundBuffer,delay,startPoint,duration){this.sound.buffer=poppsSoundBuffer.buffer;this.sound.connect(_audioManager.audioContext.destination);this.sound.start(delay,startPoint,duration);_audioManager.activeSounds.push(this)};PoppsSound.prototype.volume=function(vol){this.sound.volume=vol};PoppsSound.prototype.loop=function(){this.loops=true;this.sound.loop=true};PoppsSound.prototype.noloop=function(){this.loops=true;this.sound.loop=false};PoppsSound.prototype.stop=function(){this.sound.stop();this.sound.disconnect();_audioManager.activeSounds.splice(_audioManager.activeSounds.indexOf(this),1);this.delete()};PoppsSound.prototype.pauseSound=function(){if(this.playing){this.sound.disconnect();this.playing=false}};PoppsSound.prototype.resumeSound=function(){if(!this.playing){this.sound.connect(_audioManager.audioContext.destination);this.playing=true}};PoppsSound.prototype.delete=function(){this.ended();_audioManager.activeSounds.splice(_audioManager.activeSounds.indexOf(this),1);delete this.playing;delete this.sound;_delete(this)};PoppsSound.prototype.ended=function(){};function createVector(val1,val2,val3){if(val1&&val2&&val3){return new Vector(val1,val2,val3)}if(val1&&val2){return new Vector(val1,val2)}if(val1){return new Vector(val1,0)}return new Vector(0,0)}function Vector(val1,val2){this.x=val1;this.y=val2}Vector.prototype.set=function(val1,val2){if(val2){this.x=val1;this.y=val2;return this}if(val1){this.x=val1;this.y=0;return this}this.x=0;this.y=0;return this};Vector.prototype.mult=function(v2){if(typeof v2==="number"){this.x*=v2;this.y*=v2}else{this.x*=v2.x;this.y*=v2.y}return this};Vector.prototype.div=function(v2){if(typeof v2==="number"){this.x*=v2;this.y*=v2}else{this.x*=v2.x;this.y*=v2.y}return this};Vector.prototype.add=function(v2){if(typeof v2==="number"){this.x+=v2;this.y+=v2}else{this.x+=v2.x;this.y+=v2.y}return this};Vector.prototype.sub=function(v2){if(typeof v2==="number"){this.x-=v2;this.y-=v2}else{this.x-=v2.x;this.y-=v2.y}return this};function applyForces(pos,vel,acc){pos.add(vel);vel.add(acc)}function abs(val){return Math.abs(val)}function dist(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1))}function osc(val,center,amp,positive){if(center===undefined){return Math.sin(val)}if(amp===undefined){return Math.sin(val)+center}if(positive===undefined){return Math.sin(val)*amp+center}if(positive===true){return Math.abs(Math.sin(val))*amp+center}else if(positive===false){return-Math.abs(Math.sin(val))*amp+center}}function oscSpeed(val,center,amp,speed,positive){if(center===undefined){return Math.sin(val)}if(amp===undefined){return Math.sin(val)+center}if(speed===undefined){return Math.sin(val)*amp+center}if(positive===undefined){return Math.sin(val*speed)*amp+center}if(positive===true){return Math.abs(Math.sin(val*speed))*amp+center}else if(positive===false){return-Math.abs(Math.sin(val*speed))*amp+center}}function random(low,high){if(high){return map(Math.random(),0,1,low,high)}if(low){if(Array.isArray(low)){return low[randomInt(low.length)]}return Math.random()*low}return Math.random()}function randomInt(){var low=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var high=arguments[1];if(high){return floor(random(low,high))}return floor(random(low))}function randomRound(amp,round){if(amp===undefined){return Math.random()}if(round===undefined){return Math.random()*amp}if(typeof round==="string"){return Math.floor(Math.random()*amp)}var factor=Math.pow(10,round-3);return Math.floor(Math.random()*amp*factor)/factor}function oneIn(chance){return 1>random(chance)}function fiftyFifty(){return random(1)<.5}function map(val,low1,high1,low2,high2){val=constrain(val,low1,high1);var scale=(high2-low2)/(high1-low1);var dif=low2-low1;return val*scale+dif}function floor(val){return Math.floor(val)}function ceil(val){return Math.ceil(val)}function constrainLow(v,l){return Math.max(v,l)}function constrainHigh(v,h){return Math.min(v,h)}function min(v1,v2){return Math.min(v1,v2)}function max(v1,v2){return Math.max(v1,v2)}function constrain(v,l,h){return constrainHigh(constrainLow(v,l),h)}

//# sourceMappingURL=popps.min.js.map